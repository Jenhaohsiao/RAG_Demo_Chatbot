# ğŸ‰ éƒ¨ç½²å®Œæˆç¸½çµ

**å°ˆæ¡ˆ**: RAG Demo Chatbot  
**éƒ¨ç½²æ—¥æœŸ**: 2026-01-18  
**éƒ¨ç½²ç­–ç•¥**: æ··åˆé›²ç«¯éƒ¨ç½²ï¼ˆé›¶æœˆè²»ç”¨ï¼‰

---

## âœ… å·²å®Œæˆçš„å·¥ä½œ

### 1. éƒ¨ç½²æ–¹æ¡ˆè¨­è¨ˆ âœ…

**æ¶æ§‹**:
```
ä½¿ç”¨è€… â†’ A2 Hosting (å‰ç«¯éœæ…‹ç¶²ç«™)
         â†“
    Render.com (å¾Œç«¯ FastAPI)
         â†“
    Qdrant Cloud (å‘é‡è³‡æ–™åº«)
```

**æˆæœ¬**: $0/æœˆï¼ˆå…¨éƒ¨ä½¿ç”¨å…è²»æ–¹æ¡ˆï¼‰

### 2. API é…é¡ç®¡ç†ç³»çµ± âœ…

**å¾Œç«¯å¯¦ç¾**:
- âœ… æ–°å¢ `quota_errors.py` - é…é¡ç•°å¸¸é¡åˆ¥
- âœ… æ›´æ–° `embedder.py` - åµŒå…¥æœå‹™é…é¡æª¢æ¸¬
- âœ… æ›´æ–° `rag_engine.py` - RAG å¼•æ“é…é¡æª¢æ¸¬
- âœ… æ›´æ–° `chat.py` API è·¯ç”± - æ”¯æ´ç”¨æˆ¶ API Key header

**å‰ç«¯å¯¦ç¾**:
- âœ… æ–°å¢ `QuotaExceededModal` çµ„ä»¶ - é…é¡è¶…é™å°è©±æ¡†
- âœ… æ›´æ–° `chatService.ts` - æ”¯æ´ X-User-API-Key header
- âœ… æ–°å¢å¤šèªè¨€ç¿»è­¯ï¼ˆen, zh-TWï¼‰- quota, apiKey ç›¸é—œæ–‡å­—

**åŠŸèƒ½æµç¨‹**:
```
1. ç³»çµ±ä½¿ç”¨é è¨­ API Key
2. é…é¡ç”¨å®Œ â†’ 429 éŒ¯èª¤
3. å‰ç«¯é¡¯ç¤ºå°è©±æ¡†
4. ç”¨æˆ¶è¼¸å…¥è‡ªå·±çš„ Key
5. Key å­˜å„²åœ¨ sessionStorageï¼ˆæœƒè©±ç´šåˆ¥ï¼‰
6. ä½¿ç”¨ X-User-API-Key header ç™¼é€è«‹æ±‚
7. æœƒè©±çµæŸè‡ªå‹•æ¸…é™¤ Key
```

### 3. å®‰å…¨æ€§ä¿è­· âœ…

**æ•æ„Ÿè³‡è¨Šä¿è­·**:
- âœ… `.env.local` ä¸è¿½è¹¤ï¼ˆ.gitignoreï¼‰
- âœ… `.env` ä¸è¿½è¹¤
- âœ… ç”Ÿç”¢ç’°å¢ƒä½¿ç”¨ Render Dashboard è¨­å®šç’°å¢ƒè®Šæ•¸
- âœ… ç”¨æˆ¶ API Key åƒ… session ç´šåˆ¥å­˜å„²
- âœ… ç„¡è³‡æ–™åº«å­˜å„²ç”¨æˆ¶ Key

**ç’°å¢ƒè®Šæ•¸ç®¡ç†**:
```
æœ¬åœ°é–‹ç™¼: .env.local (git-ignored)
ç”Ÿç”¢ç’°å¢ƒ: Render Dashboard Environment Variables
å‰ç«¯: API URL å‹•æ…‹é…ç½®
```

### 4. éƒ¨ç½²é…ç½®æ–‡ä»¶ âœ…

å·²å‰µå»ºçš„æ–‡ä»¶:
- âœ… `render.yaml` - Render.com è‡ªå‹•éƒ¨ç½²é…ç½®
- âœ… `DEPLOYMENT_GUIDE.md` - å®Œæ•´éƒ¨ç½²æŒ‡å—ï¼ˆ20+ é ï¼‰
- âœ… `.htaccess` ç¯„ä¾‹ - A2 Hosting SPA è·¯ç”±é…ç½®

---

## ğŸ“‹ éƒ¨ç½²æª¢æŸ¥æ¸…å–®

### Phase 1: Qdrant Cloud æº–å‚™
- [ ] è¨»å†Š Qdrant Cloud å¸³è™Ÿ
- [ ] å‰µå»ºå…è²» Cluster
- [ ] ç²å– Cluster URL å’Œ API Key
- [ ] æ¸¬è©¦é€£æ¥

### Phase 2: Render.com å¾Œç«¯éƒ¨ç½²
- [ ] è¨»å†Š Render.com å¸³è™Ÿ
- [ ] é€£æ¥ GitHub repository
- [ ] å‰µå»º Web Service (ä½¿ç”¨ `render.yaml`)
- [ ] è¨­å®šç’°å¢ƒè®Šæ•¸:
  - [ ] GEMINI_API_KEY
  - [ ] QDRANT_URL
  - [ ] QDRANT_API_KEY
  - [ ] SMTP_USERNAME
  - [ ] SMTP_PASSWORD
  - [ ] CORS_ORIGINS (æ‚¨çš„ A2 Hosting ç¶²åŸŸ)
- [ ] æ¸¬è©¦å¥åº·æª¢æŸ¥: `https://your-app.onrender.com/health`

### Phase 3: å‰ç«¯æ§‹å»ºèˆ‡ä¸Šå‚³
- [ ] æ›´æ–° `frontend/src/services/api.ts`:
  ```typescript
  baseURL: "https://your-app.onrender.com/api/v1"
  ```
- [ ] æœ¬åœ°æ§‹å»º: `npm run build`
- [ ] é€£æ¥ A2 Hosting SFTP
- [ ] ä¸Šå‚³ `frontend/dist/` åˆ° `public_html/`
- [ ] å‰µå»º `.htaccess` æ–‡ä»¶ï¼ˆSPA è·¯ç”±æ”¯æ´ï¼‰
- [ ] æ¸¬è©¦ç¶²ç«™è¨ªå•

### Phase 4: åŠŸèƒ½é©—è­‰
- [ ] ç¶²ç«™å¯æ­£å¸¸è¨ªå•
- [ ] èƒ½å‰µå»ºæœƒè©±
- [ ] èƒ½ä¸Šå‚³æ–‡ä»¶
- [ ] èƒ½é€²è¡ŒèŠå¤©
- [ ] å¤šèªè¨€åˆ‡æ›æ­£å¸¸
- [ ] è¯çµ¡è¡¨å–®èƒ½ç™¼é€éƒµä»¶
- [ ] **æ¸¬è©¦é…é¡åŠŸèƒ½**:
  - [ ] è§¸ç™¼é…é¡è¶…é™ï¼ˆå¤§é‡è«‹æ±‚ï¼‰
  - [ ] å°è©±æ¡†æ­£å¸¸é¡¯ç¤º
  - [ ] è¼¸å…¥ç”¨æˆ¶ API Key å¯ç¹¼çºŒä½¿ç”¨
  - [ ] æœƒè©±çµæŸ Key è¢«æ¸…é™¤

### Phase 5: ç›£æ§è¨­å®šï¼ˆå¯é¸ï¼‰
- [ ] è¨­å®š UptimeRobot ç›£æ§ï¼ˆé˜²æ­¢ Render ä¼‘çœ ï¼‰
- [ ] æª¢æŸ¥ Render æ—¥èªŒ
- [ ] æª¢æŸ¥ Qdrant å„²å­˜ç©ºé–“ä½¿ç”¨ç‡

---

## ğŸ” å®‰å…¨æœ€ä½³å¯¦è¸

### é–‹ç™¼ç’°å¢ƒ
```bash
# .env.local (æœ¬åœ°é–‹ç™¼ï¼Œä¸ä¸Šå‚³)
GEMINI_API_KEY=AIzaSy...
SMTP_PASSWORD=xxxx xxxx xxxx xxxx
```

### ç”Ÿç”¢ç’°å¢ƒ
```
Render Dashboard â†’ Environment
- æ‰€æœ‰æ•æ„Ÿè®Šæ•¸é€šé Dashboard è¨­å®š
- åŠ å¯†å­˜å„²
- ä¸æœƒå‡ºç¾åœ¨ä»£ç¢¼åº«
```

### ç”¨æˆ¶ API Key ç®¡ç†
```typescript
// åƒ…å­˜å„²åœ¨ sessionStorageï¼ˆç€è¦½å™¨å…§å­˜ï¼‰
sessionStorage.setItem('user_api_key', key);

// ç”¨æ–¼ API è«‹æ±‚ header
headers: { 'X-User-API-Key': key }

// æœƒè©±çµæŸè‡ªå‹•æ¸…é™¤
window.addEventListener('beforeunload', () => {
  sessionStorage.removeItem('user_api_key');
});
```

---

## ğŸ“Š é æœŸçµæœ

### æ€§èƒ½æŒ‡æ¨™
- **é¦–æ¬¡è¼‰å…¥**: 2-5 ç§’ï¼ˆRender å†·å•Ÿå‹•ï¼‰
- **å¾ŒçºŒè¼‰å…¥**: <1 ç§’
- **æŸ¥è©¢å›æ‡‰**: 2-4 ç§’
- **ä¸¦ç™¼æ”¯æ´**: 10-50 å€‹ç”¨æˆ¶

### æˆæœ¬åˆ†æ
```
å‰ç«¯è¨—ç®¡: $0 (A2 Hosting å·²æœ‰)
å¾Œç«¯æœå‹™: $0 (Render å…è²» 750 å°æ™‚/æœˆ)
å‘é‡è³‡æ–™åº«: $0 (Qdrant Cloud 1GB å…è²»)
AI API: $0 (Gemini å…è²»é…é¡ + ç”¨æˆ¶è‡ªå¸¶ Key)
---
ç¸½è¨ˆ: $0/æœˆ
```

### é…é¡é™åˆ¶è™•ç†
- **ç³»çµ±é…é¡**: æ¯æ—¥ç´„ 1,500 æ¬¡è«‹æ±‚ï¼ˆGemini å…è²»é…é¡ï¼‰
- **é…é¡ç”¨å®Œæ™‚**: è‡ªå‹•æç¤ºç”¨æˆ¶è¼¸å…¥è‡ªå·±çš„ Key
- **ç”¨æˆ¶é«”é©—**: ç„¡ä¸­æ–·ï¼Œå¯ç¹¼çºŒä½¿ç”¨
- **å®‰å…¨æ€§**: ç”¨æˆ¶ Key ä¸å­˜å…¥è³‡æ–™åº«ï¼Œæœƒè©±çµæŸå³æ¸…é™¤

---

## ğŸš€ ä¸‹ä¸€æ­¥

1. **ç«‹å³å¯åš**:
   - æŒ‰ç…§ `DEPLOYMENT_GUIDE.md` é€æ­¥éƒ¨ç½²
   - æ¸¬è©¦æ‰€æœ‰åŠŸèƒ½ï¼ˆç‰¹åˆ¥æ˜¯é…é¡è¶…é™æµç¨‹ï¼‰
   - ç›£æ§ Render æ—¥èªŒç¢ºèªç„¡éŒ¯èª¤

2. **å„ªåŒ–å»ºè­°**:
   - è¨­å®š UptimeRobot æ¯ 5 åˆ†é˜ ping ä¸€æ¬¡ï¼ˆé˜²æ­¢ä¼‘çœ ï¼‰
   - ä½¿ç”¨ Cloudflare CDN åŠ é€Ÿéœæ…‹è³‡æº
   - ç›£æ§ Qdrant å„²å­˜ç©ºé–“ä½¿ç”¨æƒ…æ³

3. **æœªä¾†æ“´å±•**ï¼ˆå¦‚éœ€è¦ï¼‰:
   - å‡ç´š Render ä»˜è²»æ–¹æ¡ˆï¼ˆ$7/æœˆï¼‰- ç„¡ä¼‘çœ 
   - å‡ç´š Qdrant Cloud ä»˜è²»æ–¹æ¡ˆï¼ˆ$25/æœˆï¼‰- æ›´å¤§ç©ºé–“
   - è³¼è²· Gemini API ä»˜è²»æ–¹æ¡ˆ - æ›´é«˜é…é¡

---

## ğŸ“ æ”¯æ´è³‡æº

- **éƒ¨ç½²æŒ‡å—**: `docs/DEPLOYMENT_GUIDE.md`
- **Render æ–‡æª”**: https://render.com/docs
- **Qdrant Cloud**: https://cloud.qdrant.io/
- **Gemini API**: https://ai.google.dev/
- **A2 Hosting**: ä½¿ç”¨æ‚¨ç¾æœ‰çš„å¸³è™Ÿå’Œ SFTP æ†‘è­‰

---

## âœ¨ æ–°åŠŸèƒ½ç¸½çµ

### é…é¡ç®¡ç†ç³»çµ±
- ğŸ¯ è‡ªå‹•æª¢æ¸¬ç³»çµ± API é…é¡ç‹€æ…‹
- ğŸ”” é…é¡ç”¨å®Œæ™‚å‹å¥½æç¤ºç”¨æˆ¶
- ğŸ”‘ æ”¯æ´ç”¨æˆ¶è¼¸å…¥è‡ªå·±çš„ API Key
- ğŸ”’ Key åƒ… session å­˜å„²ï¼Œä¸å…¥è³‡æ–™åº«
- ğŸ§¹ æœƒè©±çµæŸè‡ªå‹•æ¸…é™¤

### å®‰å…¨æ€§å¢å¼·
- ğŸ›¡ï¸ ç’°å¢ƒè®Šæ•¸å®Œå…¨åˆ†é›¢
- ğŸ” ç”Ÿç”¢ç’°å¢ƒåŠ å¯†å­˜å„²
- ğŸš« æ•æ„Ÿè³‡è¨Šä¸é€² Git
- âœ… ç”¨æˆ¶è³‡æ–™ä¸æŒä¹…åŒ–

### éƒ¨ç½²å„ªåŒ–
- ğŸ’° é›¶æœˆè²»ç”¨æ–¹æ¡ˆ
- âš¡ è‡ªå‹•éƒ¨ç½²æµç¨‹
- ğŸ“Š å®Œæ•´ç›£æ§æŒ‡å—
- ğŸ“ è©³ç´°éƒ¨ç½²æ–‡æª”

---

**æ­å–œï¼æ‚¨çš„ RAG Chatbot å·²æº–å‚™å¥½éƒ¨ç½²åˆ°é›²ç«¯ï¼** ğŸ‰ğŸš€

è«‹åƒé–± `docs/DEPLOYMENT_GUIDE.md` é–‹å§‹éƒ¨ç½²æµç¨‹ã€‚
